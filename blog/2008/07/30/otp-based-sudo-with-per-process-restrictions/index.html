
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>'OTP' based sudo, with per process restrictions. - Hank Beaver</title>
  <meta name="author" content="Hank Beaver">

  
  <meta name="description" content="Is it possible to audit Unix/Linux server root access per task and on temporary basis? Yes. Years ago I wrote a &#8216;sudo&#8217; equivalent in W32 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blasterpal.github.com/blog/2008/07/30/otp-based-sudo-with-per-process-restrictions">
  <link href="/favicon.ico" rel="icon">
  
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Hank Beaver" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <h1>Hank Beaver</h1>
  
    <h2><a href="/">hb</a></h2>
  
</hgroup>

</header>
  <nav role="navigation">
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blasterpal.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">'OTP' Based Sudo, With Per Process Restrictions.</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-07-30T13:05:08-04:00" pubdate data-updated="true">Jul 30<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p><strong>Is it possible to audit Unix/Linux server root access per task and on temporary basis?</strong></p>

<p>Yes.</p>

<p>Years ago I wrote a &#8216;sudo&#8217; equivalent in W32, but with a big twist. It was called &#8220;RunAuth&#8221;. It used the API &#8220;run as&#8221; mechanisms. It gave admin access based on an OTP (http://en.wikipedia.org/wiki/One_time_password). The OTP was NOT automatic. The person had to call the helpdesk to get a code. It was based on a shared secret and MD5. Secondly, the code providedÂ  defined the exact process that could be executed by the RunAuth client.</p>

<p><strong>Use Case:</strong>
Field Sales Person wants to install a new HP Printer. User does NOT have local admin. How to install a printer driver without shipping computer to IT?</p>

<p><strong>Solution:</strong>
Start RunAuth, choose install printer driver, a challenge code is presented. Tell the IT person over the phone the code. They provide a response that immediately executes the install printer wizard as admin. The actual MD5 signature of the DLL or EXE is also validated before running to ensure no trojan or backdoor is created. Upon completion of task, the machine logs out the user or requires reboot.</p>

<p><strong>Point:</strong>
The same can be accomplished in Linux.
Think of sudo with one time password access. Why is this important? Because that means admins don&#8217;t have single control over root access. It requires &#8220;dual&#8221; access. Someone else who is not an admin, has to consent to the changes or stated objective to provide the admin a one time sudo password. So if the automated provisioning cannot handle a task or an emergency occurs, there is still a regimented procedure to perform ad hoc tasks,but there is change control enforced at the OS.</p>

<p>I&#8217;d like to have opinions?</p>

<p>H</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn"><a href="/about" title="About the author (Hank Beaver)" rel="author">Hank Beaver</a></span></span>

      








  


<time datetime="2008-07-30T13:05:08-04:00" pubdate data-updated="true">Jul 30<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/security/'>Security</a>, <a class='category' href='/blog/categories/linux/'>linux</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://blasterpal.github.com/blog/2008/07/30/otp-based-sudo-with-per-process-restrictions/" data-via="blastepal" data-counturl="http://blasterpal.github.com/blog/2008/07/30/otp-based-sudo-with-per-process-restrictions/" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/05/20/how-to-set-up-mongrel_cluster-on-westhost/" title="Previous Post: How to set up mongrel_cluster on Westhost">&laquo; How to set up mongrel_cluster on Westhost</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/08/22/running-finder-as-root-on-osx-to-solve-app-install-issues/" title="next Post: Running Finder as root on OSX - to solve app install issues">Running Finder as root on OSX - to solve app install issues &raquo;</a>
      
    </p>
  </footer>
</article>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Hank Beaver -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
